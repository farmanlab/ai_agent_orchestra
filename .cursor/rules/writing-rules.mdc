---
description: Enforces rule file conventions. Use when creating, editing, or reviewing files in .agents/rules/.

globs:  ".agents/rules/**/*.md"
alwaysApply: false
---


# Writing Rules

`.agents/rules/` にルールを作成・編集する際の規約。

## 命名規則

- 小文字・数字・ハイフンのみ
- 内容を明確に表す名前
- 64文字以内

```
# Good
architecture.md
testing.md
writing-skills.md

# Avoid
rules.md       # 曖昧
misc.md        # 曖昧
```

## メタデータ要件

`.agents/rules/` に作成するファイルの共通形式:

```yaml
---
description: What this rule enforces. Use when...  # 第三人称 + トリガー
paths: "**/*.{ts,tsx}"                             # 対象ファイルパターン
---
```

| フィールド | 必須 | 説明 |
|-----------|------|------|
| `description` | ✓ | 第三人称で記述、トリガー含む |
| `paths` | - | 対象ファイルパターン（glob形式） |

**paths の書き方**:
- カンマ区切り: `"**/*.ts,**/*.tsx"`
- ブレース展開: `"**/*.{ts,tsx}"`
- 省略時: 全ファイルに適用

**Note**: sync 実行時にエージェント別形式に自動変換されます。

## Claude Code メモリ階層

Claude Codeは複数レベルでルールを読み込む:

| 優先度 | 場所 | 用途 |
|--------|------|------|
| 1 (高) | `CLAUDE.md` | プロジェクト固有ルール |
| 2 | `.claude/rules/*.md` | プロジェクト詳細ルール |
| 3 | `~/.claude/CLAUDE.md` | ユーザー共通ルール |
| 4 (低) | `~/.claude/rules/*.md` | ユーザー詳細ルール |

**ルートレベル `CLAUDE.md`:**
- 最優先で読み込まれる
- プロジェクト概要、コーディング規約を記述

**インポート構文:**

```markdown
# プロジェクトルール

@.claude/rules/architecture.md
@.claude/rules/testing.md
```

## Cursor Rules

Cursor では2つの形式をサポート:

### .mdc 形式（新形式）

```
.cursor/rules/
├── architecture.mdc
└── testing.mdc
```

**Frontmatter:**

```yaml
---
description: When to apply this rule
globs: ["**/*.ts", "**/*.tsx"]
alwaysApply: false
---
```

| フィールド | 必須 | 説明 |
|-----------|------|------|
| `description` | ✓ | 適用トリガーの説明 |
| `globs` | - | 対象ファイルパターン |
| `alwaysApply` | - | 常時適用するか（default: false） |

### .md 形式（従来形式）

従来の `.cursor/rules/*.md` も引き続きサポート。

### Team Rules（チーム共有）

`.cursor/rules/` をリポジトリにコミットすることでチーム共有:

- プロジェクトルールとして自動読み込み
- ユーザールール（`~/.cursor/rules/`）より優先
- `.cursorignore` でフィルタリング可能

## ファイルサイズ

**推奨: 500行以下**

超過する場合は Progressive Disclosure で分割。

## 必須構成要素

1. **目的**: このルールが何を強制するか
2. **適用範囲**: どのファイル/場面に適用するか
3. **具体例**: Good/Bad の比較

## 具体例パターン

```markdown
## Examples

### Bad

\```typescript
// bad code
\```

### Good

\```typescript
// good code
\```

**Why**: [explanation]
```

## スコープの適切性

**タスク非依存であること**:

```markdown
# Bad - タスク固有
Fix the bug in login.js line 42

# Good - リポジトリレベル
Authentication logic should validate tokens before processing
```

## テンプレート

```yaml
---
description: Enforces X. Use when Y.
paths: "**/*.{ts,tsx}"
---

# Rule Title

## Purpose

This rule enforces [purpose].

## Scope

- TypeScript/TSX files
- [specific use cases]

## Rules

### Required

1. [Rule 1]
2. [Rule 2]

### Recommended

- [Recommendation 1]

## Examples

### Bad

\```typescript
// bad code
\```

### Good

\```typescript
// good code
\```

**Why**: [explanation]
```
