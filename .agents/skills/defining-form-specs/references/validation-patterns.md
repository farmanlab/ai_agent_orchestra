# バリデーションパターン集

一般的なフォームフィールドのバリデーションパターンを定義します。

## 目次

1. [テキスト系](#テキスト系)
2. [メール・URL](#メールurl)
3. [パスワード](#パスワード)
4. [電話番号](#電話番号)
5. [数値系](#数値系)
6. [日付・時刻](#日付時刻)
7. [選択系](#選択系)
8. [ファイル](#ファイル)
9. [依存関係](#依存関係)
10. [エラーメッセージテンプレート](#エラーメッセージテンプレート)

---

## テキスト系

### 一般テキスト

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 必須入力 |
| minLength | N | 最小N文字 |
| maxLength | N | 最大N文字 |
| pattern | regex | 正規表現マッチ |

### 名前（氏名）

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 必須 |
| maxLength | 50 | 一般的な上限 |
| pattern | `/^[ぁ-んァ-ヶー一-龠a-zA-Z\s]+$/` | 日本語・英字のみ（例） |

### ニックネーム

| ルール | 条件 | 説明 |
|--------|------|------|
| minLength | 2 | 短すぎない |
| maxLength | 20 | 表示上の制約 |
| pattern | `/^[^<>\"'&]+$/` | 禁止文字を除外 |
| unique | API確認 | 重複不可（任意） |

### 住所

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 必須 |
| maxLength | 200 | 長い住所に対応 |

---

## メール・URL

### メールアドレス

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 必須 |
| format | email (RFC 5322) | メール形式 |
| maxLength | 254 | RFC規定の上限 |
| unique | API確認 | 重複不可（登録時） |

**推奨正規表現（簡易版）**:
```
/^[^\s@]+@[^\s@]+\.[^\s@]+$/
```

**エラーメッセージ例**:
- 未入力: メールアドレスを入力してください
- 形式エラー: 有効なメールアドレスを入力してください
- 重複: このメールアドレスは既に登録されています

### URL

| ルール | 条件 | 説明 |
|--------|------|------|
| format | url | URL形式 |
| maxLength | 2048 | 一般的なブラウザ制限 |
| protocol | http/https | プロトコル制限（任意） |

**推奨正規表現**:
```
/^https?:\/\/.+/
```

---

## パスワード

### 一般的なパスワード

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 必須 |
| minLength | 8 | 最小8文字（推奨） |
| maxLength | 128 | 十分な長さを許容 |
| pattern | 複合条件 | 強度要件 |

### 強度パターン

| レベル | 条件 | 説明 |
|--------|------|------|
| 弱 | 8文字以上 | 最低限 |
| 中 | 8文字以上 + 英数字混在 | 一般的 |
| 強 | 8文字以上 + 大小英字 + 数字 + 記号 | 高セキュリティ |

**中レベル正規表現**:
```
/^(?=.*[A-Za-z])(?=.*\d).{8,}$/
```

**強レベル正規表現**:
```
/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*]).{8,}$/
```

### パスワード確認

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 必須 |
| match | password フィールド | 一致確認 |

---

## 電話番号

### 日本の電話番号

| ルール | 条件 | 説明 |
|--------|------|------|
| format | tel-jp | 日本形式 |
| minLength | 10 | ハイフンなし最小 |
| maxLength | 13 | ハイフンあり最大 |

**許容パターン**:
- `09012345678`（ハイフンなし）
- `090-1234-5678`（ハイフンあり）
- `03-1234-5678`（固定電話）

**推奨正規表現**:
```
/^0\d{9,10}$|^0\d{1,4}-\d{1,4}-\d{3,4}$/
```

### 国際電話番号

| ルール | 条件 | 説明 |
|--------|------|------|
| format | tel-international | 国際形式 |
| pattern | E.164 | +81... 形式 |

---

## 数値系

### 一般数値

| ルール | 条件 | 説明 |
|--------|------|------|
| type | number | 数値のみ |
| min | N | 最小値 |
| max | N | 最大値 |
| step | N | 刻み幅 |

### 金額

| ルール | 条件 | 説明 |
|--------|------|------|
| type | number | 数値 |
| min | 0 | 負の値を禁止 |
| max | - | 上限は要件次第 |
| format | currency | 通貨形式表示 |

### 年齢

| ルール | 条件 | 説明 |
|--------|------|------|
| type | number | 数値 |
| min | 0 | 0歳以上 |
| max | 150 | 妥当な上限 |
| integer | - | 整数のみ |

### 郵便番号（日本）

| ルール | 条件 | 説明 |
|--------|------|------|
| format | postal-jp | 日本形式 |
| pattern | `/^\d{3}-?\d{4}$/` | 7桁 |

---

## 日付・時刻

### 日付

| ルール | 条件 | 説明 |
|--------|------|------|
| format | date | 日付形式 |
| min | 日付 | 最小日付 |
| max | 日付 | 最大日付 |

### 生年月日

| ルール | 条件 | 説明 |
|--------|------|------|
| format | date | 日付形式 |
| min | 1900-01-01 | 妥当な最小 |
| max | today | 未来日付を禁止 |
| age | 18+ | 年齢制限（任意） |

### 時刻

| ルール | 条件 | 説明 |
|--------|------|------|
| format | time | 時刻形式 |
| min | 時刻 | 最小時刻 |
| max | 時刻 | 最大時刻 |

### 日時範囲

| ルール | 条件 | 説明 |
|--------|------|------|
| start < end | - | 開始 < 終了 |
| duration | min/max | 期間制限 |

---

## 選択系

### セレクトボックス

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 選択必須 |
| options | リスト | 有効な選択肢 |

### チェックボックス（単一）

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | チェック必須（利用規約同意等） |

### チェックボックス（複数）

| ルール | 条件 | 説明 |
|--------|------|------|
| minSelected | N | 最小N個選択 |
| maxSelected | N | 最大N個選択 |

### ラジオボタン

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 選択必須 |
| options | リスト | 有効な選択肢 |

---

## ファイル

### 画像ファイル

| ルール | 条件 | 説明 |
|--------|------|------|
| required | - | 必須（任意） |
| accept | image/* | 画像のみ |
| maxSize | 5MB | ファイルサイズ上限 |
| dimensions | 800x800 min | 最小サイズ（任意） |

**許容形式例**: jpg, jpeg, png, gif, webp

### ドキュメント

| ルール | 条件 | 説明 |
|--------|------|------|
| accept | .pdf,.doc,.docx | 許容形式 |
| maxSize | 10MB | ファイルサイズ上限 |

### 複数ファイル

| ルール | 条件 | 説明 |
|--------|------|------|
| minFiles | N | 最小N個 |
| maxFiles | N | 最大N個 |
| totalMaxSize | 50MB | 合計サイズ上限 |

---

## 依存関係

### フィールド間の依存

| パターン | 説明 | 例 |
|----------|------|-----|
| match | 値が一致 | パスワード確認 |
| different | 値が異なる | 新旧パスワード |
| requiredIf | 条件付き必須 | 「その他」選択時の入力 |
| requiredUnless | 条件付き必須 | 代替フィールド |
| greaterThan | より大きい | 終了日 > 開始日 |

### 条件付きバリデーション

```markdown
if (fieldA === 'other') {
  fieldB: required
}
```

---

## エラーメッセージテンプレート

### 汎用テンプレート

| ルール | テンプレート |
|--------|-------------|
| required | {フィールド名}を入力してください |
| minLength | {フィールド名}は{N}文字以上で入力してください |
| maxLength | {フィールド名}は{N}文字以内で入力してください |
| min | {フィールド名}は{N}以上で入力してください |
| max | {フィールド名}は{N}以下で入力してください |
| pattern | {フィールド名}の形式が正しくありません |
| format | 有効な{形式}を入力してください |
| match | {フィールド名}が一致しません |
| unique | この{フィールド名}は既に使用されています |

### フィールド別の例

| フィールド | ルール | メッセージ |
|-----------|--------|-----------|
| メールアドレス | required | メールアドレスを入力してください |
| メールアドレス | format | 有効なメールアドレスを入力してください |
| パスワード | minLength | パスワードは8文字以上で入力してください |
| パスワード | pattern | パスワードは英数字を含めてください |
| 電話番号 | format | 有効な電話番号を入力してください |
| 生年月日 | max | 未来の日付は選択できません |
| ファイル | maxSize | ファイルサイズは{N}MB以下にしてください |

---

## バリデーションタイミングの推奨

| フィールドタイプ | タイミング | 理由 |
|-----------------|-----------|------|
| テキスト（短文） | onBlur | 入力完了後に検証 |
| テキスト（長文） | debounced (500ms) | 入力中の負荷軽減 |
| メールアドレス | onBlur + debounced | 形式: onBlur、重複: debounced |
| パスワード | onChange (強度) + onBlur (検証) | 強度はリアルタイム表示 |
| 数値 | onChange | 即座にフィードバック |
| 日付 | onChange | 選択後即座に検証 |
| セレクト | onChange | 選択後即座に検証 |
| チェックボックス | onChange | チェック後即座に検証 |
| ファイル | onChange | 選択後即座に検証 |
| 全フィールド | onSubmit | 最終確認 |
