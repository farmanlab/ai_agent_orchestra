---
name: explain-pr
description: Explains GitHub PR changes based on user's technical proficiency level. Use when reviewing or learning from pull request changes.
---

# Explain PR Command

## 目次

1. [概要](#概要)
2. [使用方法](#使用方法)
3. [実行手順](#実行手順)
   - [Step 1: PR情報の取得](#step-1-pr情報の取得)
   - [Step 2: 習熟度レベルの確認](#step-2-習熟度レベルの確認)
   - [Step 3: レベル別の解説生成](#step-3-レベル別の解説生成)
   - [Step 4: 出力とフィードバック](#step-4-出力とフィードバック)
4. [注意事項](#注意事項)
5. [エラーハンドリング](#エラーハンドリング)

---

## 概要

このコマンドは、GitHub PRのURLを受け取り、その変更内容をユーザーの技術レベルに応じて適切な詳細度で解説します。初心者から上級者まで、それぞれの理解度に合わせた説明を提供することで、効果的なコードレビューと学習を支援します。

## 使用方法

```bash
/explain-pr <pr-url> [proficiency-level]
```

**引数**:

- `pr-url` (必須): GitHub PRのURL
  - 例: `https://github.com/owner/repo/pull/123`
- `proficiency-level` (省略可、デフォルト: intermediate): ユーザーの習熟度レベル
  - `beginner`: 初心者向け - 基本的な用語から丁寧に説明
  - `intermediate`: 中級者向け - 実装の詳細と設計判断を解説
  - `advanced`: 上級者向け - アーキテクチャへの影響と潜在的問題を分析

**使用例**:

```bash
# 中級者向け（デフォルト）
/explain-pr https://github.com/facebook/react/pull/28000

# 初心者向け
/explain-pr https://github.com/facebook/react/pull/28000 beginner

# 上級者向け
/explain-pr https://github.com/facebook/react/pull/28000 advanced
```

## 実行手順

### Step 1: PR情報の取得

GitHub CLIを使用してPR情報を取得します。

```bash
# PRの基本情報を取得
gh pr view <pr-url> --json title,body,author,additions,deletions,changedFiles,baseRefName,headRefName

# PRの差分を取得
gh pr diff <pr-url>

# PRのファイル一覧を取得
gh pr view <pr-url> --json files --jq '.files[].path'
```

使用ツール:

- `Bash`: GitHub CLI (`gh`) コマンドの実行
- `Read`: 必要に応じてローカルファイルの読み込み
- `Grep`: 特定パターンの検索

### Step 2: 習熟度レベルの確認

引数で指定されたレベル、または対話的に確認します。

レベルが指定されていない場合、`AskUserQuestion` ツールで確認:

```text
あなたの技術レベルを教えてください:
1. 初心者 (beginner) - プログラミング基礎を学習中
2. 中級者 (intermediate) - 実務経験あり、設計パターンに興味
3. 上級者 (advanced) - アーキテクチャ設計、パフォーマンス最適化の経験あり
```

### Step 3: レベル別の解説生成

#### Beginner (初心者向け)

**焦点**:

- 何が変更されたか（What）
- なぜ変更が必要だったか（Why）
- 基本的な用語の説明
- コードの読み方

**解説構造**:

```markdown
## 変更の概要

[平易な言葉で変更内容を説明]

## 主な変更点

### 1. [ファイル名]

**何をしているか**:
[変更の目的を初心者にも分かる言葉で]

**用語解説**:

- **用語1**: 説明
- **用語2**: 説明

**変更前**:
[コード + 各行の説明コメント]

**変更後**:
[コード + 各行の説明コメント]

**なぜこの変更が必要か**:
[ビジネス的な理由や技術的な理由を平易に]

## 学習ポイント

- このPRから学べる概念やパターン
- 参考リソース（公式ドキュメントなど）
```

#### Intermediate (中級者向け)

**焦点**:

- どのように実装されたか（How）
- 設計判断の理由
- ベストプラクティスとの比較
- 代替実装の検討

**解説構造**:

```markdown
## 変更サマリー

[変更の目的と影響範囲]

## 実装の詳細

### [ファイル名] - [変更の種類]

**設計判断**:
[なぜこの実装方法を選択したか]

**変更内容**:
[diff形式で表示]

**ベストプラクティス**:

- 適用されているパターン: [パターン名と理由]
- 考慮点: [潜在的な懸念があれば]

**代替案との比較**:

- 案A: [メリット・デメリット]
- 案B（採用）: [メリット・デメリット]

## テストカバレッジ

[追加されたテスト、カバレッジの変化]

## 影響範囲

- 影響を受けるモジュール
- 既存機能への影響
```

#### Advanced (上級者向け)

**焦点**:

- アーキテクチャへの影響
- パフォーマンス考慮事項
- スケーラビリティ
- 潜在的な問題と改善提案

**解説構造**:

```markdown
## アーキテクチャ分析

### 変更の位置づけ

[システム全体における変更の役割]

### 設計原則への準拠

- **SOLID原則**: [適用状況]
- **DDD**: [ドメイン境界、集約の整合性]
- **Clean Architecture**: [レイヤー間の依存関係]

## パフォーマンス影響

### 計算量分析

- 時間計算量: O(?) → O(?)
- 空間計算量: O(?) → O(?)

### ボトルネック評価

[潜在的なボトルネックとプロファイリング推奨箇所]

### スケーラビリティ

- 水平スケーリング: [影響]
- 垂直スケーリング: [影響]

## セキュリティ考慮

[認証、認可、入力検証、XSS/CSRF対策など]

## 技術的負債

**導入される負債**:
[今回の変更で発生する技術的負債]

**解消される負債**:
[リファクタリングで改善された点]

## 改善提案

### 短期的改善

1. [具体的な改善案]
2. [具体的な改善案]

### 長期的改善

1. [アーキテクチャレベルの改善]
2. [パフォーマンス最適化]

## 関連する設計パターン/アーキテクチャ

[Repository Pattern, Factory Pattern, Event Sourcingなど]

## 参考文献

- 関連するRFC、ADR（Architecture Decision Record）
- 参考にした技術記事や論文
```

### Step 4: 出力とフィードバック

生成した解説をMarkdown形式で出力します。

```markdown
# PR解説: [PR タイトル]

**PR URL**: [URL]
**習熟度レベル**: [beginner/intermediate/advanced]
**解説日時**: [日時]

[レベル別の解説内容]

---

## 質問やフィードバック

この解説で不明な点があれば、お気軽にご質問ください。
```

不明点が残る場合、ユーザーに追加説明を提供します。

## 注意事項

- `gh` CLIがインストールされていない場合は、インストールを案内
- GitHub認証が必要な場合は `gh auth login` を案内
- プライベートリポジトリの場合は適切な権限が必要
- 大規模なPR（50ファイル以上）の場合、主要な変更に焦点を当てて解説
- 機密情報（APIキー、パスワードなど）が含まれる場合は適切にマスク
- 解説の長さはレベルに応じて調整（初心者: 詳細、上級者: 簡潔）

## エラーハンドリング

**PR URLが無効な場合**:

```text
指定されたURLが無効です。以下の形式で指定してください:
https://github.com/owner/repo/pull/123
```

**GitHub CLIがインストールされていない場合**:

```text
GitHub CLI (gh) がインストールされていません。
インストール方法: https://cli.github.com/
```

**認証エラーの場合**:

```bash
# 認証を実行
gh auth login
```

**PRが見つからない場合**:

```text
指定されたPRが見つかりません。URLを確認してください。
プライベートリポジトリの場合は、アクセス権限があるか確認してください。
```
